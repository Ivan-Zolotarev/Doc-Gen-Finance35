# Руководство по использованию веб-приложения

## Запуск веб-приложения

1. **Установите зависимости:**
```bash
pip install -r requirements.txt
```

2. **Создайте шаблоны (если еще не созданы):**
```bash
python templates/create_templates.py
```

3. **Запустите сервер:**
```bash
python app.py
```

4. **Откройте в браузере:**
```
http://127.0.0.1:5000
```

## Использование веб-интерфейса

### Генерация Word документа

1. На главной странице нажмите "Создать" на карточке "Word документ"
2. Заполните форму:
   - **Шаблон** (опционально) - загрузите свой шаблон .docx или оставьте пустым
   - **Номер договора** - например, "ДГ-2024-001"
   - **Дата** - выберите дату
   - **Стороны** - укажите названия организаций
   - **Предмет договора** - описание
   - **Сумма и срок** - финансовые данные
   - **Подписи** - ФИО подписантов
3. Нажмите "Сгенерировать документ"
4. Документ автоматически скачается

### Генерация PDF документа

1. Нажмите "Создать" на карточке "PDF документ"
2. Заполните форму:
   - **Заголовок** - название документа
   - **Дата** - дата создания
   - **Содержимое** - основной текст
   - **Подпись** - ФИО подписанта
   - **Табличные данные** (опционально) - JSON формат:
     ```json
     [["Заголовок1", "Заголовок2"], ["Данные1", "Данные2"]]
     ```
3. Нажмите "Сгенерировать PDF"
4. PDF файл будет скачан

### Генерация Excel таблицы

1. Нажмите "Создать" на карточке "Excel таблица"
2. Заполните форму:
   - **Заголовок отчета** - название
   - **Название листа** - имя листа в Excel
   - **Табличные данные** - JSON массив массивов:
     ```json
     [
       ["Месяц", "Выручка", "Расходы"],
       ["Январь", "35000", "28000"],
       ["Февраль", "38000", "30000"]
     ]
     ```
   - **Дополнительные данные** (опционально) - JSON объект:
     ```json
     {
       "Средняя выручка": "38333 руб.",
       "Средние расходы": "30000 руб."
     }
     ```
3. Нажмите "Сгенерировать Excel"
4. Файл .xlsx будет скачан

## Формат JSON данных

### Для таблиц (table_data):
```json
[
  ["Заголовок1", "Заголовок2", "Заголовок3"],
  ["Данные1", "Данные2", "Данные3"],
  ["Данные4", "Данные5", "Данные6"]
]
```
Первая строка - заголовки, остальные - данные.

### Для дополнительных данных (additional_data):
```json
{
  "Ключ1": "Значение1",
  "Ключ2": "Значение2"
}
```

## Загрузка шаблонов

Вы можете загрузить собственный шаблон при создании документа:
- Для Word: файл .docx
- Шаблон должен содержать переменные в формате `{{variable_name}}`
- Например: `{{contract_number}}`, `{{date}}`, `{{party1_name}}`

## API Endpoints

### POST /generate
Генерация документа через API

**Параметры:**
- `doc_type` - тип документа (word, pdf, excel)
- `template_file` - файл шаблона (опционально)
- Остальные поля зависят от типа документа

**Ответ:** Файл для скачивания

### GET /templates
Список доступных шаблонов

### GET /api/templates
API для получения списка шаблонов (JSON)

### GET /health
Проверка работоспособности сервера

## Решение проблем

### Ошибка "Module not found"
Убедитесь, что все зависимости установлены:
```bash
pip install -r requirements.txt
```

### Ошибка при генерации
- Проверьте формат JSON данных
- Убедитесь, что все обязательные поля заполнены
- Проверьте логи в консоли сервера

### Документ не скачивается
- Проверьте настройки браузера (разрешения на скачивание)
- Попробуйте другой браузер
- Проверьте консоль браузера на ошибки JavaScript

## Безопасность

⚠️ **Важно для production:**
- Измените `SECRET_KEY` в `app.py`
- Настройте ограничения на размер загружаемых файлов
- Добавьте аутентификацию для доступа к приложению
- Используйте HTTPS
- Ограничьте доступ к директориям uploads и output

## Развертывание

### Для production используйте:
```bash
gunicorn -w 4 -b 0.0.0.0:5000 app:app
```

Или с помощью waitress (Windows):
```bash
pip install waitress
waitress-serve --host=0.0.0.0 --port=5000 app:app
```

